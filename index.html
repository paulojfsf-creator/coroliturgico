<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Coro Paroquial S√£o Jo√£o Batista de Rio Caldo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&family=Lato:wght@400;700&family=Noto+Serif:wght@400;600&display=swap" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <style>
    :root {
      --bg-soft: #f3f4f6;
      --card: #ffffff;
      --border-subtle: #d1d5db;
      --text-main: #0f172a;
      --text-muted: #6b7280;
      --primary: #004b80;
      --primary-soft: #d6e4ff;
      --header-bg: var(--primary);
      --header-text: #ffffff;
      --body-bg-gradient: radial-gradient(circle at top left, #0f172a 0, #020617 35%, #020617 100%);
    }

    :root.dark {
      --bg-soft: #020617;
      --card: #020617;
      --border-subtle: #1f2937;
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --body-bg-gradient: radial-gradient(circle at top left, #020617 0, #000000 70%);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      background: var(--body-bg-gradient);
      min-height: 100vh;
      color: var(--text-main);
      font-family: 'Poppins', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      transition: background 0.35s ease, color 0.2s ease;
    }

    body.liturgic-advento,
    body.liturgic-quaresma {
      --header-bg: #4b2c6f;
      --body-bg-gradient: radial-gradient(circle at top left, #3c1f57 0, #0f0a19 70%);
      transition: all 0.6s ease;
    }
    body.liturgic-natal,
    body.liturgic-pascoa {
      --header-bg: #92400e;
      --body-bg-gradient: radial-gradient(circle at top left, #7a3e00 0, #1a0f00 70%);
      transition: all 0.6s ease;
    }
    body.liturgic-tempocomum {
      --header-bg: #166534;
      --body-bg-gradient: radial-gradient(circle at top left, #0f3d22 0, #07140c 70%);
      transition: all 0.6s ease;
    }

    header {
      background: var(--header-bg);
      color: var(--header-text);
      padding: 0.9rem 1.4rem;
      box-shadow: 0 10px 30px rgba(15,23,42,0.6);
      position: sticky;
      top: 0;
      z-index: 20;
      transition: background 0.3s ease;
    }
    .header-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1.2rem;
      flex-wrap: wrap;
    }
    .header-main {
      display: flex;
      align-items: center;
      gap: 1rem;
      min-width: 0;
    }
    .header-logo {
      height: 80px;
      width: auto;
      border-radius: 10px;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.45));
      background: white;
      padding: 5px;
      transition: transform 0.3s ease;
    }
    .header-logo:hover {
      transform: scale(1.05);
    }
    .header-text {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      min-width: 0;
    }
    header h1 {
      margin: 0;
      font-size: 1.3rem;
      font-weight: 600;
      letter-spacing: 0.03em;
      display: flex;
      align-items: center;
      gap: 0.4rem;
      white-space: nowrap;
    }
    header p {
      margin: 0;
      font-size: 0.82rem;
      opacity: 0.96;
    }

    .liturgical-pill {
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      border-radius: 999px;
      background: rgba(15,23,42,0.22);
      padding: 0.2rem 0.6rem;
      font-size: 0.75rem;
      align-self: flex-start;
    }
    .header-actions {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    main {
      max-width: 1100px;
      margin: 1.5rem auto 2.5rem;
      padding: 0 1rem;
    }
    .card {
      background: var(--card);
      border-radius: 1rem;
      padding: 1rem 1.25rem 1.25rem;
      box-shadow:
        0 22px 45px rgba(15,23,42,0.35),
        0 0 0 1px rgba(148,163,184,0.18);
      margin-bottom: 0.7rem;
      backdrop-filter: blur(12px);
      transition: background 0.2s ease, box-shadow 0.2s ease;
    }

    .tabs {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 0.7rem;
      flex-wrap: wrap;
      padding: 0.5rem;
      border-radius: 0;
      background: #1f2937;
      position: sticky;
      top: 4.2rem;
      z-index: 10;
    }
    .tabs button {
      border: none;
      background: transparent;
      padding: 0.6rem 1rem;
      border-radius: 0;
      font-size: 0.875rem;
      cursor: pointer;
      transition: background 0.15s, color 0.15s, transform 0.1s, box-shadow 0.15s;
      color: #e2e8f0;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      white-space: nowrap;
      font-weight: 500;
    }
    .tabs button span.dot {
      width: 0.5rem;
      height: 0.5rem;
      border-radius: 0;
      background: #64748b;
    }
    .tabs button.active {
      background: #0f172a;
      color: #f9fafb;
      box-shadow: 0 4px 12px rgba(15,23,42,0.65);
      transform: translateY(-1px);
    }
    .tabs button.active span.dot { background: #22c55e; }
    .tabs button:hover:not(.active) {
      transform: translateY(-1px);
      background: rgba(15,23,42,0.7);
    }

    .tab { display: none; }
    .tab.active {
      display: block;
      animation: fadeIn 0.18s ease-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(4px); }
      to   { opacity: 1; transform: translateY(0);  }
    }

    label {
      display: block;
      font-size: 0.86rem;
      margin-bottom: 0.25rem;
      font-weight: 500;
      color: #111827;
    }
    input[type="text"],
    input[type="number"],
    input[type="date"],
    input[type="time"],
    select,
    textarea {
      width: 100%;
      box-sizing: border-box;
      padding: 0.4rem 0.55rem;
      border-radius: 0.55rem;
      border: 1px solid #d0d4da;
      font-size: 0.9rem;
      margin-bottom: 0.7rem;
      font-family: inherit;
      background: #f9fafb;
      transition: border-color 0.12s, box-shadow 0.12s, background 0.12s;
    }
    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 1px rgba(37,99,235,0.2);
      background: #ffffff;
    }
    textarea { min-height: 160px; resize: vertical; }

    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .col {
      flex: 1 1 220px;
      min-width: 0;
    }

    .btn {
      border: none;
      padding: 0.5rem 0.9rem;
      border-radius: 0;
      background: var(--primary);
      color: #ffffff;
      cursor: pointer;
      font-size: 0.9rem;
      margin-top: 0.3rem;
      transition: transform 0.08s, box-shadow 0.12s, background 0.12s;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      white-space: nowrap;
      font-weight: 500;
    }
    .btn.secondary {
      background: #e5e7eb;
      color: #111827;
      border: 1px solid #d1d5db;
    }
    .btn.small {
      padding: 0.3rem 0.6rem;
      font-size: 0.8rem;
    }
    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }
    .btn:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 4px 14px rgba(15,23,42,0.25);
    }
    .btn.btn-delete {
      background: #ef4444;
      color: white;
      border: none;
    }
    .btn.btn-delete:hover {
      background: #dc2626;
      box-shadow: 0 4px 14px rgba(239,68,68,0.4);
    }
    .btn-toggle {
      border-radius: 999px;
      padding: 0.3rem 0.7rem;
      font-size: 0.8rem;
      background: rgba(15,23,42,0.25);
      color: #e5e7eb;
    }

    .small { font-size: 0.8rem; color: #6b7280; }
    .muted { color: #9ca3af; font-size: 0.75rem; }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.75rem;
    }
    th, td {
      border-bottom: 1px solid #e5e7eb;
      padding: 0.4rem 0.4rem;
      text-align: left;
      vertical-align: top;
    }
    th {
      background: #f9fafb;
      font-weight: 600;
      font-size: 0.8rem;
      color: #4b5563;
    }
    a {
      color: #2563eb;
      text-decoration: none;
      font-size: 0.8rem;
    }
    a:hover { text-decoration: underline; }

    .toast-container {
      position: fixed;
      right: 1rem;
      bottom: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
      z-index: 60;
      pointer-events: none;
    }
    .toast {
      background: #111827;
      color: #f9fafb;
      padding: 0.45rem 0.9rem;
      border-radius: 999px;
      font-size: 0.8rem;
      box-shadow: 0 12px 30px rgba(15,23,42,0.6);
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      opacity: 0;
      transform: translateY(6px);
      animation: toast-in 0.18s forwards;
      pointer-events: auto;
    }
    .toast--success { background: #16a34a; }
    .toast--error   { background: #b91c1c; }
    @keyframes toast-in {
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes toast-out {
      to { opacity: 0; transform: translateY(6px); }
    }

    #previewContainer {
      max-width: 21cm;
      min-height: 6cm;
      margin: 0.5rem auto 1.5rem auto;
      padding: 0.7cm 0.7cm 0.7cm 1.2cm;
      border: 1px dashed var(--border-subtle);
      border-radius: 0.4rem;
      background: #ffffff;
      box-shadow: 0 5px 12px rgba(15,23,42,0.08);
      column-count: 2;
      column-gap: 1.5cm;
      font-size: 0.9rem;
    }
    #previewContainer .song-block {
      break-inside: avoid;
      margin-bottom: 0.5rem;
    }
    #previewContainer h3 {
      margin-top: 0;
      text-align: center;
      font-size: 1rem;
    }

    

    /* Folheto typography */
    .leaflet-a4 {
      font-family: 'Noto Serif', 'Times New Roman', serif;
    }
    .leaflet-song-title {
      font-family: 'Lato', 'Poppins', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }
    .leaflet-note {
      font-family: 'Lato', 'Poppins', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
/* Folheto */
    .leaflet-frame {
      background:white;
      border-radius:0.75rem;
      border:1px solid var(--border);
      padding:0.75rem;
      max-height:80vh;
      overflow:auto;
    }
    .leaflet-a4 {
      width:794px;
      min-height:1123px;
      margin:0 auto;
      padding:1.2cm 1cm 1.2cm 1.6cm;
      box-shadow:0 10px 35px rgba(15,23,42,0.12);
      position:relative;
      background:white;
      color:black;
    }
    .leaflet-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.6rem;
      padding: 0.4rem 0.6rem;
      border-radius: 0.6rem;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      gap: 1rem;
    }
    .leaflet-header-left img {
      max-height: 80px;
      max-width: 150px;
      object-fit: contain;
      flex-shrink: 0;
    }
    .leaflet-header-center {
      flex: 1;
      text-align: center;
      min-width: 0;
    }
    .leaflet-header-right img {
      max-height: 80px;
      max-width: 150px;
      object-fit: contain;
      flex-shrink: 0;
    }
    .leaflet-header-center h2 {
      margin: 0;
      font-size: 1.35rem;
      word-wrap: break-word;
      hyphens: auto;
    }
    .leaflet-header-center .meta {
      font-size:0.8rem;
      color:#4b5563;
    }
    .leaflet-line {
      height:3px;
      width:65%;
      margin:0.35rem auto 0.15rem auto;
      border-radius:999px;
      background:#e5e7eb;
    }
    .leaflet-note {
      font-size:0.75rem;
      color:#6b7280;
      text-align:center;
      margin-bottom:0.4rem;
    }
    .leaflet-cols {
      column-count:2;
      column-gap:1.4rem;
      font-size:0.85rem;
    }
    .leaflet-song {
      break-inside: avoid;
      break-inside: avoid-column;
      page-break-inside: avoid;
      -webkit-column-break-inside: avoid;
      display: inline-block;
      width: 100%;
      margin-bottom: 0.5rem;
    }
    .leaflet-song-title {
      font-weight: 600;
      break-inside: avoid;
      page-break-inside: avoid;
    }
    .leaflet-song-meta {
      font-size: 0.75rem;
      color: #6b7280;
      margin-bottom: 0.15rem;
      break-inside: avoid;
      page-break-inside: avoid;
    }
    .leaflet-song-lyrics {
      margin: 0;
      white-space: pre-wrap;
      font-family: inherit;
      font-size: 0.8rem;
      break-inside: avoid;
      page-break-inside: avoid;
    }
    .leaflet-song-lyrics .chord {
      color:#b91c1c;
      font-weight:700;
    }
    .leaflet-footer {
      position:absolute;
      bottom:0.5cm;
      left:1.6cm;
      right:1cm;
      font-size:0.7rem;
      color:#9ca3af;
      display:flex;
      justify-content:space-between;
    }
    
@media (max-width: 768px) {
      .header-inner { align-items: flex-start; }
      header h1, header p { white-space: normal; }
      .row { flex-direction: column; }
      #previewContainer { column-count: 1; padding: 0.6cm; }
      .tabs { 
        top: 4.4rem; 
        overflow-x: auto; 
        gap: 0.3rem;
        padding: 0.3rem;
        border-radius: 0;
      }
      .tabs button {
        font-size: 0.75rem;
        padding: 0.5rem 0.7rem;
        border-radius: 0;
        min-width: fit-content;
      }
      .tabs button span.dot {
        width: 0.4rem;
        height: 0.4rem;
      }
      .btn {
        padding: 0.6rem 1rem;
        font-size: 0.85rem;
        width: 100%;
        justify-content: center;
      }
      .btn.small {
        padding: 0.4rem 0.7rem;
        font-size: 0.75rem;
        width: auto;
      }
      input, select, textarea {
        font-size: 16px !important;
      }
      .card {
        padding: 1rem;
      }
    }

    @media (max-width: 480px) {
      .tabs {
        gap: 0.2rem;
        padding: 0.2rem;
      }
      .tabs button {
        font-size: 0.7rem;
        padding: 0.4rem 0.6rem;
        gap: 0.25rem;
      }
      .tabs button span.dot {
        width: 0.35rem;
        height: 0.35rem;
      }
      .btn {
        font-size: 0.8rem;
        padding: 0.55rem 0.9rem;
      }
      .btn.small {
        font-size: 0.7rem;
        padding: 0.35rem 0.6rem;
      }
      header h1 {
        font-size: 1.3rem;
      }
      .card {
        padding: 0.8rem;
      }
    }

    @media print {
      @page {
        size: A4 portrait;
        margin: 1cm 1cm 1cm 2cm;
      }
      body { background: #ffffff !important; }
      header,
      .tabs,
      #tab-programa,
      #tab-sugestoes,
      #tab-historico,
      #tab-catalogo,
      #tab-partituras,
      #tab-videos,
      #tab-ensaios,
      #tab-folhetos,
      .toast-container { display: none !important; }
      #tab-preview,
      #previewContainer {
        display: block !important;
        box-shadow: none !important;
        border: none !important;
        padding: 0 !important;
        margin: 0 !important;
      }
      #previewContainer { column-count: 2; }
    }
  
/* Modais para programa (sele√ß√£o e edi√ß√£o de letra) */
.modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(15, 23, 42, 0.55);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 80;
}
.modal-backdrop[hidden] {
  display: none;
}
.modal {
  background: #ffffff;
  color: inherit;
  border-radius: 0.75rem;
  padding: 1rem 1.25rem;
  max-width: 720px;
  width: 100%;
  box-shadow: 0 20px 45px rgba(15,23,42,0.35);
}
.modal h3 {
  margin-top: 0;
  margin-bottom: 0.5rem;
  font-size: 0.95rem;
  text-align: left;
}
.modal textarea {
  width: 100%;
  min-height: 180px;
  resize: vertical;
  font-family: inherit;
  font-size: 0.9rem;
}
.modal .modal-actions {
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
  margin-top: 0.75rem;
}
.modal small {
  font-size: 0.75rem;
  color: #6b7280;
}
.program-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 0.25rem;
  margin-top: 0.25rem;
}
.program-buttons .btn.small {
  padding: 0.15rem 0.4rem;
  font-size: 0.7rem;
}
.song-select-filters {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  margin-bottom: 0.75rem;
}
.song-select-filters .col {
  flex: 1 1 160px;
}
.song-select-list {
  max-height: 360px;
  overflow-y: auto;
  border-top: 1px solid #e5e7eb;
  padding-top: 0.5rem;
}
.song-select-item {
  padding: 0.4rem 0;
  border-bottom: 1px dashed #e5e7eb;
}
.song-select-item-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.2rem;
}
.song-select-title {
  font-weight: 600;
  font-size: 0.9rem;
}
.song-select-meta {
  font-size: 0.75rem;
  color: #6b7280;
  margin-bottom: 0.2rem;
}
.song-select-actions .btn.small {
  margin-right: 0.25rem;
  margin-bottom: 0.15rem;
}


@page { size: A4 portrait; margin: 2cm 1cm 1cm 2cm; }
#previewContainer { column-count: 2; column-gap: 1.5cm; }


/* Modal centrado */
.use-modal {
  position: fixed; inset:0;
  background: rgba(0,0,0,0.55);
  display:flex; align-items:center; justify-content:center;
  z-index:2000;
}
.use-modal-box {
  background: var(--card,#fff);
  padding:20px; border-radius:12px;
  min-width:260px; max-width:340px;
  box-shadow:0 8px 30px rgba(0,0,0,.2);
  animation: fadeIn .18s ease-out;
}
.use-modal-list button{
  display:block; width:100%; margin:6px 0;
  padding:8px 12px;
  border-radius:8px; border:1px solid var(--border-subtle,#ccc);
  background:var(--bg2,#f5f5f5); cursor:pointer;
}
.use-modal-list button:hover{ background:#e0e7ff; }
@keyframes fadeIn{ from{opacity:0; transform:scale(.95);} to{opacity:1; transform:scale(1);} }


/* Bot√µes do cat√°logo ‚Äì estilo Material Design */
#songsTableContainer button {
  border: none;
  border-radius: 999px;
  padding: 6px 14px;
  font-size: 0.8rem;
  font-weight: 600;
  background: rgba(0,0,0,0.05);
  cursor: pointer;
  transition: box-shadow .15s ease, transform .12s ease, background .12s ease;
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

#songsTableContainer button:hover {
  background: rgba(0,0,0,0.08);
  transform: translateY(-1px);
}

#songsTableContainer button.primary-action {
  background: var(--accent, #4f46e5);
  color: #fff;
}

#songsTableContainer button.primary-action:hover {
  box-shadow: 0 3px 10px rgba(79,70,229,0.35);
}

/* Dashboard cards */
.card-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(180px,1fr));
  gap: 0.75rem;
  margin-bottom: 0.8rem;
}
.card-grid .dash-card {
  padding: 0.75rem 0.9rem;
  border-radius: 0.75rem;
  background: rgba(255,255,255,0.7);
  box-shadow: 0 8px 24px rgba(15,23,42,0.04);
  border: 1px solid rgba(148,163,184,0.35);
}
.card-grid .dash-card h3 {
  margin: 0 0 0.35rem;
  font-size: 0.95rem;
}
.card-grid .dash-card p {
  margin: 0;
}
.card-grid .tiny {
  font-size: 0.75rem;
}
.card-grid .dash-actions {
  display: flex;
  gap: 0.2rem;
  flex-wrap: wrap;
  margin-top: 0.25rem;
}

/* Pequenos utilit√°rios do gestor de ensaios */
.rehearsal-song-row {
  margin-bottom: 0.5rem;
}
.tiny-gap .col {
  padding-right: 0.25rem;
}
.tiny-divider {
  border: 0;
  border-top: 1px dashed rgba(148,163,184,0.5);
  margin: 0.5rem 0;
}

/* Calend√°rio Lit√∫rgico */
.dashboard-layout {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  margin-top: 0.5rem;
  align-items: start;
}

@media (max-width: 1024px) {
  .dashboard-layout {
    grid-template-columns: 1fr;
  }
}

.liturgical-calendar {
  background: var(--card);
  border-radius: 0.5rem;
  padding: 0.4rem;
  box-shadow: 0 4px 12px rgba(15,23,42,0.1);
  max-width: 10cm;
  width: 10cm;
  margin: 0 auto;
  font-size: 0.7rem;
}

.upcoming-celebrations {
  background: var(--card);
  border-radius: 0.5rem;
  padding: 0.6rem;
  box-shadow: 0 4px 12px rgba(15,23,42,0.1);
  height: fit-content;
  max-height: 100%;
  overflow-y: auto;
  font-size: 0.75rem;
}

.upcoming-celebrations h3 {
  font-size: 0.8rem;
  margin: 0 0 0.6rem 0;
  color: var(--text-main);
  display: flex;
  align-items: center;
  gap: 0.3rem;
}

.calendar-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.3rem;
  padding-bottom: 0.3rem;
  border-bottom: 1px solid var(--border-subtle);
}

.calendar-header h3 {
  margin: 0;
  font-size: 0.75rem;
  display: flex;
  align-items: center;
  gap: 0.3rem;
}

.calendar-nav {
  display: flex;
  gap: 0.2rem;
}

.calendar-nav button {
  padding: 0.2rem 0.4rem;
  border-radius: 0.3rem;
  border: 1px solid var(--border-subtle);
  background: transparent;
  cursor: pointer;
  transition: all 0.2s;
  font-size: 0.65rem;
}

.calendar-nav button:hover {
  background: var(--primary-soft);
  transform: translateY(-1px);
}

.calendar-month-year {
  text-align: center;
  font-weight: 600;
  font-size: 0.85rem;
  margin-bottom: 0.5rem;
  color: var(--primary);
}

.calendar-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 0.1rem;
}

.calendar-day-header {
  text-align: center;
  font-size: 0.6rem;
  font-weight: 600;
  color: var(--text-muted);
  padding: 0.2rem;
  text-transform: uppercase;
}

.calendar-day {
  aspect-ratio: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  border-radius: 0.25rem;
  font-size: 0.65rem;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
  background: var(--bg-soft);
  border: 1px solid transparent;
  min-height: 1.2cm;
}

.calendar-day:hover {
  background: var(--primary-soft);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.calendar-day.other-month {
  opacity: 0.3;
  cursor: default;
}

.calendar-day.other-month:hover {
  background: var(--bg-soft);
  transform: none;
  box-shadow: none;
}

.calendar-day.today {
  background: var(--primary);
  color: white;
  font-weight: 700;
  border-color: var(--primary);
}

.calendar-day.liturgical-event {
  background: linear-gradient(135deg, var(--event-color, var(--primary)) 0%, var(--event-color, var(--primary)) 100%);
  color: white;
  font-weight: 600;
  border: 2px solid var(--event-color, var(--primary));
}

.calendar-day.liturgical-event::after {
  content: '‚Ä¢';
  position: absolute;
  bottom: 2px;
  font-size: 1rem;
  line-height: 1;
}

.calendar-day.has-program {
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
  color: white;
  font-weight: 700;
  border: 2px solid #059669;
  position: relative;
}

.calendar-day.has-program::before {
  content: '‚úì';
  position: absolute;
  top: 2px;
  right: 4px;
  font-size: 0.9rem;
  font-weight: 700;
}

.calendar-day.has-program:hover {
  background: linear-gradient(135deg, #059669 0%, #047857 100%);
  transform: translateY(-3px) scale(1.05);
  box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4);
}

.calendar-day.liturgical-event.has-program {
  background: linear-gradient(135deg, var(--event-color, var(--primary)) 0%, var(--event-color, var(--primary)) 100%);
  border: 3px solid var(--event-color, var(--primary));
  box-shadow: 0 0 0 2px #fff, 0 0 0 4px #10b981;
}

.calendar-day.liturgical-event.has-program::after {
  content: '‚úì';
  bottom: 2px;
  right: 4px;
  font-size: 1rem;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}

.calendar-day.advento { --event-color: #7c3aed; }
.calendar-day.natal { --event-color: #eab308; }
.calendar-day.quaresma { --event-color: #7c2d12; }
.calendar-day.pascoa { --event-color: #fafafa; color: #000; }
.calendar-day.festa { --event-color: #dc2626; }
.calendar-day.solenidade { --event-color: #059669; }

.calendar-day-number {
  font-size: 0.95rem;
  line-height: 1;
}

.calendar-day-indicator {
  font-size: 0.6rem;
  margin-top: 0.15rem;
}

.liturgical-events-list {
  margin-top: 0.5rem;
  padding-top: 1rem;
  border-top: 2px solid var(--border-subtle);
}

.liturgical-events-list h4 {
  font-size: 1rem;
  margin-bottom: 0.75rem;
  color: var(--text-main);
}

.event-item {
  display: flex;
  gap: 0.4rem;
  padding: 0.4rem;
  margin-bottom: 0.3rem;
  border-radius: 0.3rem;
  background: var(--bg-soft);
  transition: all 0.2s;
  font-size: 0.7rem;
}

.event-item:hover {
  background: var(--primary-soft);
  transform: translateX(2px);
}

.event-date {
  font-weight: 700;
  font-size: 0.7rem;
  color: var(--primary);
  min-width: 40px;
}

.event-details {
  flex: 1;
}

.event-title {
  font-weight: 600;
  font-size: 0.7rem;
  margin-bottom: 0.1rem;
}

.event-type {
  font-size: 0.6rem;
  color: var(--text-muted);
  display: inline-block;
  padding: 0.1rem 0.3rem;
  border-radius: 0.2rem;
  background: rgba(0,0,0,0.05);
}

.event-type.advento { background: #ede9fe; color: #7c3aed; }
.event-type.natal { background: #fef3c7; color: #92400e; }
.event-type.quaresma { background: #fef2f2; color: #7c2d12; }
.event-type.pascoa { background: #f0fdf4; color: #166534; }
.event-type.festa { background: #fee2e2; color: #dc2626; }
.event-type.solenidade { background: #d1fae5; color: #059669; }

/* Modal de Programa do Dia */
.program-day-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(4px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  animation: fadeIn 0.2s ease-out;
  padding: 1rem;
}

.program-day-content {
  background: var(--card);
  border-radius: 1rem;
  padding: 1.5rem;
  max-width: 600px;
  width: 100%;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 24px 60px rgba(15,23,42,0.6);
  animation: slideUp 0.3s ease-out;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.program-day-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 0.8rem;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid var(--border-subtle);
}

.program-day-header h3 {
  margin: 0;
  font-size: 1.3rem;
  color: var(--text-main);
}

.program-day-date {
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-top: 0.25rem;
}

.program-day-close {
  background: transparent;
  border: none;
  font-size: 1.5rem;
  cursor: pointer;
  color: var(--text-muted);
  padding: 0.25rem;
  line-height: 1;
  border-radius: 0.5rem;
  transition: all 0.2s;
}

.program-day-close:hover {
  background: var(--bg-soft);
  color: var(--text-main);
}

.program-day-info {
  margin-bottom: 0.8rem;
}

.program-info-row {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
  font-size: 0.9rem;
}

.program-info-label {
  font-weight: 600;
  color: var(--text-main);
  min-width: 100px;
}

.program-info-value {
  color: var(--text-muted);
  flex: 1;
}

.program-day-parts {
  margin-top: 0.5rem;
}

.program-day-parts h4 {
  font-size: 1rem;
  margin-bottom: 0.75rem;
  color: var(--text-main);
}

.program-part-item {
  background: var(--bg-soft);
  padding: 0.75rem;
  border-radius: 0.5rem;
  margin-bottom: 0.5rem;
  border-left: 3px solid var(--primary);
}

.program-part-label {
  font-weight: 600;
  font-size: 0.75rem;
  color: var(--primary);
  margin-bottom: 0.25rem;
}

.program-part-song {
  font-size: 0.9rem;
  color: var(--text-main);
}

.program-day-actions {
  display: flex;
  gap: 0.75rem;
  margin-top: 0.5rem;
  padding-top: 1rem;
  border-top: 2px solid var(--border-subtle);
}

.program-day-actions .btn {
  flex: 1;
}

.no-program-message {
  text-align: center;
  padding: 2rem 1rem;
  color: var(--text-muted);
}

.no-program-message i {
  font-size: 3rem;
  opacity: 0.3;
  margin-bottom: 0.7rem;
  display: block;
}

.calendar-legend {
  margin-top: 0.3rem;
  padding-top: 0.4rem;
  border-top: 1px solid var(--border-subtle);
  font-size: 0.65rem;
}

@media (max-width: 768px) {
  .calendar-day-header {
    font-size: 0.65rem;
    padding: 0.3rem;
  }
  
  .calendar-day {
    font-size: 0.75rem;
  }
  
  .calendar-nav button {
    padding: 0.3rem 0.5rem;
    font-size: 0.75rem;
  }
}

/* Modo impress√£o do folheto */
@media print {
  body {
    margin: 0;
    background: #fff;
  }
  .no-print, .tabs, header, footer {
    display: none !important;
  }
  #tab-programa {
    display: block !important;
  }
  #previewContainer {
    box-shadow: none;
    border: none;
    padding: 0;
  }
  @page {
    size: A4 portrait;
    margin-top: var(--print-margin-top, 1.5cm);
    margin-bottom: var(--print-margin-bottom, 1cm);
    margin-left: var(--print-margin-left, 1.5cm);
    margin-right: var(--print-margin-right, 1cm);
  }
}

/* Vari√°veis de margem edit√°veis */
:root {
  --print-margin-top: 1.5cm;
  --print-margin-bottom: 1cm;
  --print-margin-left: 1.5cm;
  --print-margin-right: 1cm;
}

</style>

<style>
.btn.btn-xs, .btn-xs {
  padding: 0.15rem 0.45rem;
  font-size: 0.75rem;
  border-radius: 999px;
}

/* Modal centrado */
.use-modal {
  position: fixed; inset:0;
  background: rgba(0,0,0,0.55);
  display:flex; align-items:center; justify-content:center;
  z-index:2000;
}
.use-modal-box {
  background: var(--card,#fff);
  padding:20px; border-radius:12px;
  min-width:260px; max-width:340px;
  box-shadow:0 8px 30px rgba(0,0,0,.2);
  animation: fadeIn .18s ease-out;
}
.use-modal-list button{
  display:block; width:100%; margin:6px 0;
  padding:8px 12px;
  border-radius:8px; border:1px solid var(--border-subtle,#ccc);
  background:var(--bg2,#f5f5f5); cursor:pointer;
}
.use-modal-list button:hover{ background:#e0e7ff; }
@keyframes fadeIn{ from{opacity:0; transform:scale(.95);} to{opacity:1; transform:scale(1);} }

</style>
<style>
#lyricsEditor .ql-editor {
  min-height:250px;
  font-size:0.9rem;
  line-height:1.4;
}
#lyricsEditor .ql-editor .chord {
  color:#b91c1c;
  font-weight:700;
}
.modal-dialog .ql-toolbar {
  border-radius:8px 8px 0 0;
}
.modal-dialog .ql-container {
  border-radius:0 0 8px 8px;
}

/* Modal centrado */
.use-modal {
  position: fixed; inset:0;
  background: rgba(0,0,0,0.55);
  display:flex; align-items:center; justify-content:center;
  z-index:2000;
}
.use-modal-box {
  background: var(--card,#fff);
  padding:20px; border-radius:12px;
  min-width:260px; max-width:340px;
  box-shadow:0 8px 30px rgba(0,0,0,.2);
  animation: fadeIn .18s ease-out;
}
.use-modal-list button{
  display:block; width:100%; margin:6px 0;
  padding:8px 12px;
  border-radius:8px; border:1px solid var(--border-subtle,#ccc);
  background:var(--bg2,#f5f5f5); cursor:pointer;
}
.use-modal-list button:hover{ background:#e0e7ff; }
@keyframes fadeIn{ from{opacity:0; transform:scale(.95);} to{opacity:1; transform:scale(1);} }

</style>


<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>

<style>
#lyricsModal .modal-backdrop {
    z-index: 1000 !important;
}
#lyricsModal .modal-dialog {
    z-index: 1001 !important;
    position: fixed;
    max-height: 80vh;
    overflow-y: auto;
}

/* Modal centrado */
.use-modal {
  position: fixed; inset:0;
  background: rgba(0,0,0,0.55);
  display:flex; align-items:center; justify-content:center;
  z-index:2000;
}
.use-modal-box {
  background: var(--card,#fff);
  padding:20px; border-radius:12px;
  min-width:260px; max-width:340px;
  box-shadow:0 8px 30px rgba(0,0,0,.2);
  animation: fadeIn .18s ease-out;
}
.use-modal-list button{
  display:block; width:100%; margin:6px 0;
  padding:8px 12px;
  border-radius:8px; border:1px solid var(--border-subtle,#ccc);
  background:var(--bg2,#f5f5f5); cursor:pointer;
}
.use-modal-list button:hover{ background:#e0e7ff; }
@keyframes fadeIn{ from{opacity:0; transform:scale(.95);} to{opacity:1; transform:scale(1);} }

</style>


<style>
.folheto-letra {
    white-space: pre-line;
    text-align: left;
    line-height: 1.45;
    font-size: 1.05rem;
}

/* Modal centrado */
.use-modal {
  position: fixed; inset:0;
  background: rgba(0,0,0,0.55);
  display:flex; align-items:center; justify-content:center;
  z-index:2000;
}
.use-modal-box {
  background: var(--card,#fff);
  padding:20px; border-radius:12px;
  min-width:260px; max-width:340px;
  box-shadow:0 8px 30px rgba(0,0,0,.2);
  animation: fadeIn .18s ease-out;
}
.use-modal-list button{
  display:block; width:100%; margin:6px 0;
  padding:8px 12px;
  border-radius:8px; border:1px solid var(--border-subtle,#ccc);
  background:var(--bg2,#f5f5f5); cursor:pointer;
}
.use-modal-list button:hover{ background:#e0e7ff; }
@keyframes fadeIn{ from{opacity:0; transform:scale(.95);} to{opacity:1; transform:scale(1);} }

</style>


<style>
/* Melhorias visuais dos modais principais */
.modal-backdrop {
  backdrop-filter: blur(10px) saturate(140%);
}
.modal {
  border-radius: 1rem;
  padding: 1.25rem 1.6rem;
  max-width: 760px;
  box-shadow: 0 24px 60px rgba(15,23,42,0.6);
  animation: fadeIn 0.2s ease-out;
  transform-origin: center top;
}
:root.dark .modal {
  background: #020617;
  box-shadow: 0 24px 60px rgba(15,23,42,0.9);
}
.modal h3 {
  display: flex;
  align-items: center;
  gap: 0.4rem;
}
.modal .modal-actions {
  gap: 0.6rem;
}
</style>

<style>
/* Estilo lit√∫rgico premium */
:root {
  --lit-green: #15803d;
  --lit-purple: #6d28d9;
  --lit-red: #b91c1c;
  --lit-white: #e5e7eb;
  --lit-gold: #fbbf24;
}

.badge-usage {
  display: inline-flex;
  align-items: center;
  padding: 0.1rem 0.45rem;
  border-radius: 999px;
  font-size: 0.7rem;
  background: rgba(24, 119, 242, 0.1);
  border: 1px solid rgba(24, 119, 242, 0.25);
  color: #1d4ed8;
  margin-left: 0.35rem;
  white-space: nowrap;
}

.song-select-item {
  transition: transform 0.18s ease, box-shadow 0.18s ease, background 0.18s ease;
}
.song-select-item:hover {
  transform: translateY(-1px);
  box-shadow: 0 8px 22px rgba(15,23,42,0.18);
}

button, .btn {
  transition: transform 0.18s ease, box-shadow 0.18s ease, background-color 0.18s ease, color 0.18s ease;
}
button:hover, .btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 18px rgba(15,23,42,0.25);
}
button:active, .btn:active {
  transform: translateY(0) scale(0.98);
  box-shadow: 0 2px 8px rgba(15,23,42,0.3);
}

/* Modais com entrada/sa√≠da suave */
.modal-backdrop {
  backdrop-filter: blur(10px) saturate(140%);
  animation: modalFadeIn 0.18s ease-out;
}
.modal-backdrop.modal-closing {
  animation: modalFadeOut 0.18s ease-in forwards;
}
.modal {
  border-radius: 1rem;
  box-shadow: 0 24px 60px rgba(15,23,42,0.7);
  transform-origin: center top;
  animation: modalContentIn 0.2s ease-out;
}
:root.dark .modal {
  background: #020617;
}

@keyframes modalFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
@keyframes modalFadeOut {
  from { opacity: 1; }
  to { opacity: 0; }
}
@keyframes modalContentIn {
  from { opacity: 0; transform: translateY(-8px) scale(0.97); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}

/* Tabela do hist√≥rico de c√¢nticos */
#songHistoryTableContainer table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 0.5rem;
  font-size: 0.8rem;
}
#songHistoryTableContainer th,
#songHistoryTableContainer td {
  padding: 0.35rem 0.5rem;
  border-bottom: 1px solid rgba(148,163,184,0.4);
  text-align: left;
}
#songHistoryTableContainer th {
  font-weight: 600;
  background: rgba(15,23,42,0.03);
}
#songHistoryTableContainer tr:hover td {
  background: rgba(15,23,42,0.03);
}

</style>

<style>
/* Tema lit√∫rgico premium ‚Äì acentos por cor lit√∫rgica */
:root {
  --accent: #4b5563;
  --accent-soft: rgba(75, 85, 99, 0.1);
}

body.lit-green {
  --accent: #15803d;
  --accent-soft: rgba(21, 128, 61, 0.1);
}
body.lit-purple {
  --accent: #6d28d9;
  --accent-soft: rgba(109, 40, 217, 0.12);
}
body.lit-red {
  --accent: #b91c1c;
  --accent-soft: rgba(185, 28, 28, 0.12);
}
body.lit-white {
  --accent: #d4d4d8;
  --accent-soft: rgba(212, 212, 216, 0.15);
}
body.lit-gold {
  --accent: #fbbf24;
  --accent-soft: rgba(251, 191, 36, 0.12);
}

.leaflet-header-center h2 {
  letter-spacing: 0.03em;
}
.leaflet-header-center .meta {
  color: var(--accent);
}

.badge-usage {
  background: var(--accent-soft);
  border-color: var(--accent);
  color: var(--accent);
}

/* Melhorias mobile/responsivo */
@media (max-width: 768px) {
  .tabs {
    flex-wrap: wrap;
    gap: 0.25rem;
  }
  .tabs button {
    flex: 1 1 auto;
    min-width: 140px;
  }
  .row {
    flex-direction: column;
  }
  .program-grid {
    grid-template-columns: 1fr !important;
  }
  #previewContainer {
    column-count: 1 !important;
  }
  .leaflet-a4 {
    padding: 1rem;
  }
}

/* Pequenos realces lit√∫rgicos nos t√≠tulos de sec√ß√µes */
.program-section-title {
  border-left: 4px solid var(--accent);
  padding-left: 0.4rem;
}
</style>
</head>
<body>
<header>
  <div class="header-inner">
    <div class="header-main">
      <img class="header-logo" src="logo.png" alt="Logotipo do Coro">
      <div class="header-text">
        <h1 id="headerTitle">Coro Paroquial S√£o Jo√£o Batista de Rio Caldo</h1>
        <p id="headerSubtitle">Ferramenta lit√∫rgica para prepara√ß√£o de c√¢nticos dominicais</p>
        <div class="liturgical-pill" id="liturgicalInfoPill">
          <span id="liturgicalIcon">üéµ</span>
          <span id="liturgicalInfoText">Tempo lit√∫rgico n√£o definido</span>
        </div>
      </div>
    </div>
    <div class="header-actions">
      <button type="button" class="btn-toggle" id="themeToggleBtn">üåô Modo escuro</button>
    </div>
  </div>
</header>

<main>
  <div class="card">
    
    <nav class="tabs">
      <button type="button" class="active" data-tab="tab-dashboard"><span class="dot"></span> P√°gina inicial</button>
      <button type="button" data-tab="tab-programa"><span class="dot"></span> Programa</button>
      <button type="button" data-tab="tab-folhetos"><span class="dot"></span> Folhetos</button>
      <button type="button" data-tab="tab-catalogo"><span class="dot"></span> Cat√°logo</button>
      <button type="button" data-tab="tab-partituras"><span class="dot"></span> Partituras</button>
      <button type="button" data-tab="tab-videos"><span class="dot"></span> V√≠deos</button>
      <button type="button" data-tab="tab-historico"><span class="dot"></span> Hist√≥rico</button>
      <button type="button" data-tab="tab-ensaios"><span class="dot"></span> Ensaios</button>
    </nav>



    <section id="tab-dashboard" class="tab active">
      <!-- Layout: Calend√°rio + Celebra√ß√µes lado a lado -->
      <div class="dashboard-layout">
        <!-- Calend√°rio Lit√∫rgico -->
        <div class="liturgical-calendar">
          <div class="calendar-header">
            <h3>üìÖ Calend√°rio Lit√∫rgico</h3>
            <div class="calendar-nav">
              <button type="button" id="prevMonth" title="M√™s anterior">‚Äπ</button>
              <button type="button" id="todayBtn" title="Hoje">Hoje</button>
              <button type="button" id="nextMonth" title="Pr√≥ximo m√™s">‚Ä∫</button>
            </div>
          </div>
          
          <div class="calendar-month-year" id="calendarMonthYear"></div>
          
          <div class="calendar-grid" id="calendarGrid">
            <!-- Cabe√ßalhos dos dias -->
            <div class="calendar-day-header">Dom</div>
            <div class="calendar-day-header">Seg</div>
            <div class="calendar-day-header">Ter</div>
            <div class="calendar-day-header">Qua</div>
            <div class="calendar-day-header">Qui</div>
            <div class="calendar-day-header">Sex</div>
            <div class="calendar-day-header">S√°b</div>
            <!-- Dias ser√£o adicionados aqui pelo JavaScript -->
          </div>
          
          <div class="calendar-legend">
            <h4 style="font-size: 0.75rem; margin-bottom: 0.4rem; color: var(--text-main);">üìñ Legenda</h4>
            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; font-size: 0.7rem;">
              <div style="display: flex; align-items: center; gap: 0.3rem;">
                <span style="width: 14px; height: 14px; border-radius: 3px; background: #10b981; display: inline-block;"></span>
                <span>‚úì Com programa</span>
              </div>
              <div style="display: flex; align-items: center; gap: 0.3rem;">
                <span style="width: 14px; height: 14px; border-radius: 3px; background: var(--primary); display: inline-block;"></span>
                <span>Hoje</span>
              </div>
              <div style="display: flex; align-items: center; gap: 0.3rem;">
                <span style="width: 14px; height: 14px; border-radius: 3px; background: #7c3aed; display: inline-block;"></span>
                <span>Advento/Quaresma</span>
              </div>
              <div style="display: flex; align-items: center; gap: 0.3rem;">
                <span style="width: 14px; height: 14px; border-radius: 3px; background: #eab308; display: inline-block;"></span>
                <span>Natal</span>
              </div>
              <div style="display: flex; align-items: center; gap: 0.3rem;">
                <span style="width: 14px; height: 14px; border-radius: 3px; background: #f5f5f5; border: 1px solid #ddd; display: inline-block;"></span>
                <span>P√°scoa</span>
              </div>
            </div>
            <p style="margin-top: 0.4rem; font-size: 0.65rem; color: var(--text-muted); font-style: italic;">
              üí° Clique num dia com programa (‚úì) para ver detalhes
            </p>
          </div>
        </div>
        
        <!-- Pr√≥ximas Celebra√ß√µes (ao lado) -->
        <div class="upcoming-celebrations">
          <h3>üéÑ Pr√≥ximas Celebra√ß√µes</h3>
          <div id="upcomingEvents"></div>
        </div>
      </div>
    </section>

    <section id="tab-programa" class="tab">
      <form id="programForm">
        <h2>Programa lit√∫rgico</h2>
        <p class="small">Escolhe a data e os c√¢nticos. O tempo lit√∫rgico, o ciclo e o n√∫mero do domingo s√£o calculados automaticamente.</p>

        <div class="row">
          <div class="col">
            <label for="date">Data</label>
            <input type="date" id="date" required>
          </div>
          <div class="col">
            <label for="liturgicalTitle">T√≠tulo lit√∫rgico</label>
            <input type="text" id="liturgicalTitle" placeholder="ex.: XXXIII Domingo do Tempo Comum ‚Äî Ano C">
          </div>
        </div>

        <div class="row">
          <div class="col">
            <label for="extraTheme">Tema extra / ocasi√£o</label>
            <input type="text" id="extraTheme" placeholder="ex.: Festa da Padroeira, Profiss√£o de F√©‚Ä¶">
          </div>
          <div class="col">
            <label for="cycleDisplay">Tempo / ciclo (auto)</label>
            <input type="text" id="cycleDisplay" disabled>
          </div>
        </div>

        <hr>

        <div class="row">
          <div class="col">
            <label for="entrada">Entrada</label>
            <select id="entrada"></select>
            <div class="program-buttons">
              <button type="button" class="btn secondary small program-select-btn" data-part-id="entrada">Selecionar</button>
              <button type="button" class="btn secondary small program-lyrics-btn" data-part-id="entrada">Editar letra</button>
              <button type="button" class="btn secondary small program-media-btn" data-part-id="entrada">V√≠deo/√°udio</button>
            </div>
          </div>
          <div class="col">
            <label for="atoPenitencial">Ato Penitencial</label>
            <select id="atoPenitencial"></select>
            <div class="program-buttons">
              <button type="button" class="btn secondary small program-select-btn" data-part-id="atoPenitencial">Selecionar</button>
              <button type="button" class="btn secondary small program-lyrics-btn" data-part-id="atoPenitencial">Editar letra</button>
              <button type="button" class="btn secondary small program-media-btn" data-part-id="atoPenitencial">V√≠deo/√°udio</button>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col">
            <label for="gloria">Gl√≥ria</label>
            <select id="gloria"></select>
            <div class="program-buttons">
              <button type="button" class="btn secondary small program-select-btn" data-part-id="gloria">Selecionar</button>
              <button type="button" class="btn secondary small program-lyrics-btn" data-part-id="gloria">Editar letra</button>
              <button type="button" class="btn secondary small program-media-btn" data-part-id="gloria">V√≠deo/√°udio</button>
            </div>
          </div>
          <div class="col">
            <label for="salmo">Salmo Responsorial</label>
            <select id="salmo"></select>
            <div class="program-buttons">
              <button type="button" class="btn secondary small program-select-btn" data-part-id="salmo">Selecionar</button>
              <button type="button" class="btn secondary small program-lyrics-btn" data-part-id="salmo">Editar letra</button>
              <button type="button" class="btn secondary small program-media-btn" data-part-id="salmo">V√≠deo/√°udio</button>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col">
            <label for="aclamacao">Aclama√ß√£o ao Evangelho</label>
            <select id="aclamacao"></select>
            <div class="program-buttons">
              <button type="button" class="btn secondary small program-select-btn" data-part-id="aclamacao">Selecionar</button>
              <button type="button" class="btn secondary small program-lyrics-btn" data-part-id="aclamacao">Editar letra</button>
              <button type="button" class="btn secondary small program-media-btn" data-part-id="aclamacao">V√≠deo/√°udio</button>
            </div>
          </div>
          <div class="col">
            <label for="ofertorio">Ofert√≥rio</label>
            <select id="ofertorio"></select>
            <div class="program-buttons">
              <button type="button" class="btn secondary small program-select-btn" data-part-id="ofertorio">Selecionar</button>
              <button type="button" class="btn secondary small program-lyrics-btn" data-part-id="ofertorio">Editar letra</button>
              <button type="button" class="btn secondary small program-media-btn" data-part-id="ofertorio">V√≠deo/√°udio</button>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col">
            <label for="santo">Santo</label>
            <select id="santo"></select>
            <div class="program-buttons">
              <button type="button" class="btn secondary small program-select-btn" data-part-id="santo">Selecionar</button>
              <button type="button" class="btn secondary small program-lyrics-btn" data-part-id="santo">Editar letra</button>
              <button type="button" class="btn secondary small program-media-btn" data-part-id="santo">V√≠deo/√°udio</button>
            </div>
          </div>
          <div class="col">
            <label for="paiNosso">Pai Nosso</label>
            <select id="paiNosso"></select>
            <div class="program-buttons">
              <button type="button" class="btn secondary small program-select-btn" data-part-id="paiNosso">Selecionar</button>
              <button type="button" class="btn secondary small program-lyrics-btn" data-part-id="paiNosso">Editar letra</button>
              <button type="button" class="btn secondary small program-media-btn" data-part-id="paiNosso">V√≠deo/√°udio</button>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col">
            <label for="paz">Paz</label>
            <select id="paz"></select>
            <div class="program-buttons">
              <button type="button" class="btn secondary small program-select-btn" data-part-id="paz">Selecionar</button>
              <button type="button" class="btn secondary small program-lyrics-btn" data-part-id="paz">Editar letra</button>
              <button type="button" class="btn secondary small program-media-btn" data-part-id="paz">V√≠deo/√°udio</button>
            </div>
          </div>
          <div class="col">
            <label for="cordeiro">Cordeiro de Deus</label>
            <select id="cordeiro"></select>
            <div class="program-buttons">
              <button type="button" class="btn secondary small program-select-btn" data-part-id="cordeiro">Selecionar</button>
              <button type="button" class="btn secondary small program-lyrics-btn" data-part-id="cordeiro">Editar letra</button>
              <button type="button" class="btn secondary small program-media-btn" data-part-id="cordeiro">V√≠deo/√°udio</button>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col">
            <label for="comunhao">Comunh√£o</label>
            <select id="comunhao"></select>
            <div class="program-buttons">
              <button type="button" class="btn secondary small program-select-btn" data-part-id="comunhao">Selecionar</button>
              <button type="button" class="btn secondary small program-lyrics-btn" data-part-id="comunhao">Editar letra</button>
              <button type="button" class="btn secondary small program-media-btn" data-part-id="comunhao">V√≠deo/√°udio</button>
            </div>
          </div>
          <div class="col">
            <label for="acaoGracas">A√ß√£o de Gra√ßas</label>
            <select id="acaoGracas"></select>
            <div class="program-buttons">
              <button type="button" class="btn secondary small program-select-btn" data-part-id="acaoGracas">Selecionar</button>
              <button type="button" class="btn secondary small program-lyrics-btn" data-part-id="acaoGracas">Editar letra</button>
              <button type="button" class="btn secondary small program-media-btn" data-part-id="acaoGracas">V√≠deo/√°udio</button>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col">
            <label for="final">Final</label>
            <select id="final"></select>
            <div class="program-buttons">
              <button type="button" class="btn secondary small program-select-btn" data-part-id="final">Selecionar</button>
              <button type="button" class="btn secondary small program-lyrics-btn" data-part-id="final">Editar letra</button>
              <button type="button" class="btn secondary small program-media-btn" data-part-id="final">V√≠deo/√°udio</button>
            </div>
          </div>
        </div>


        <div class="row" style="align-items:center; margin-top:0.5rem;">
          <div class="col">
            <button type="submit" class="btn">Guardar domingo no hist√≥rico</button>
          </div>
          <div class="col" style="text-align:right;">
            <button type="button" class="btn secondary" id="assemblySheetBtn" style="margin-left:0.4rem;">Folheto assembleia</button>
<button type="button" class="btn secondary" id="assemblySheetBtnNoLyrics" style="margin-left:0.4rem;">Folheto (sem letras)</button>
          </div>
        </div>
      
<div style="margin-top:20px;">
  <label><strong>Imagem do Domingo / Solenidade:</strong></label><br>
  <input type="file" id="uploadSundayImage" accept="image/*" style="margin-top: 0.5rem;">
  <button type="button" class="btn secondary small" id="removeSundayImage" style="margin-left: 0.5rem; display: none;">
    üóëÔ∏è Remover Imagem
  </button>
  
  <!-- Preview da imagem -->
  <div id="sundayImagePreview" style="margin-top: 1rem; display: none;">
    <img id="sundayImagePreviewImg" src="" alt="Preview" style="max-width: 300px; max-height: 200px; border-radius: 0.5rem; border: 2px solid var(--border);">
  </div>
</div>


</form>
    </section>

    <!-- Container invis√≠vel para gera√ß√£o de folhetos (usado pela funcionalidade de Folhetos Guardados) -->
    <div id="previewContainer" style="display: none;"></div>

    <section id="tab-folhetos" class="tab">
      <h2>üìã Folhetos Guardados</h2>
      <p class="small">Os folhetos ficam guardados apenas neste dispositivo (localStorage).</p>
      
      <div class="row" style="margin-bottom: 1rem; align-items: center;">
        <div class="col">
          <button type="button" class="btn" id="saveCurrentLeafletBtn">üíæ Guardar Folheto Atual</button>
        </div>
        <div class="col text-right">
          <small id="leafletsSummary" class="small muted"></small>
        </div>
      </div>
      
      <div id="savedLeafletsContainer" class="small muted">
        Ainda n√£o h√° folhetos guardados.
      </div>
      
      <div style="margin-top: 1rem;">
        <button type="button" class="btn btn-delete small" id="clearAllLeafletsBtn">üóëÔ∏è Limpar TODOS os Folhetos</button>
      </div>
      
      <!-- Modal de visualiza√ß√£o de folheto -->
      <div id="leafletViewModal" class="modal-backdrop" style="display:none;">
        <div class="modal" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
          <h3 id="leafletViewTitle">Folheto</h3>
          <div id="leafletViewContent" style="background: white; padding: 1rem; border-radius: 0.5rem;">
          </div>
          <div style="margin-top: 1rem; display: flex; gap: 0.5rem; justify-content: flex-end;">
            <button type="button" class="btn secondary" id="leafletViewPrint">üñ®Ô∏è Imprimir</button>
            <button type="button" class="btn secondary" id="leafletViewClose">Fechar</button>
          </div>
        </div>
      </div>
    </section>

    <section id="tab-catalogo" class="tab">
      <h2>Cat√°logo de c√¢nticos</h2>
      <p class="small">
        O cat√°logo √© carregado automaticamente a partir do Google Sheets.<br>
        Se necess√°rio, podes carregar tamb√©m um CSV manual.
      </p>

      <div class="row align-center small" style="margin-top:0.5rem;margin-bottom:0.5rem;">
        <div class="col">
          <button type="button" class="btn secondary tiny" id="refreshCatalogBtn">Atualizar cat√°logo agora</button>
        </div>
        <div class="col">
          <span id="catalogStatus" class="tiny muted">Cat√°logo carregado automaticamente ao abrir.</span>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <label for="filterAuthor">Filtrar por autor</label>
          <select id="filterAuthor">
            <option value="">Todos</option>
          </select>
        </div>
        <div class="col">
          <label for="filterTheme">Filtrar por tema</label>
          <select id="filterTheme">
            <option value="">Todos</option>
          </select>
        </div>
        <div class="col">
          <label for="songSearch">Procurar por t√≠tulo</label>
          <input type="text" id="songSearch" placeholder="Escreve parte do t√≠tulo‚Ä¶">
        </div>
      </div>

      <p class="small" style="margin-top:0;">Carregamento manual (opcional):</p>
      <input type="file" id="csvFile" accept=".csv">
      <button class="btn secondary" id="loadCsvBtn">Carregar CSV manualmente</button>
      <div id="csvError" class="small" style="color:#b91c1c;display:none;"></div>

      <hr>

      <!-- Sec√ß√£o de C√¢nticos Personalizados -->
      <div style="background: var(--bg-soft); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
        <div class="row align-center">
          <div class="col">
            <h3 style="margin: 0;">üìù C√¢nticos Personalizados</h3>
            <p class="small muted" style="margin: 0.25rem 0 0 0;">Adiciona c√¢nticos pr√≥prios com partituras em PDF ou imagem</p>
          </div>
          <div class="col text-right">
            <button type="button" class="btn" id="addCustomSongBtn">‚ûï Adicionar C√¢ntico</button>
          </div>
        </div>
        <div id="customSongsContainer" style="margin-top: 1rem;"></div>
      </div>

      <hr>

      <div id="songsTableContainer" class="small muted">
        A carregar cat√°logo do Google Sheets‚Ä¶
      </div>
    </section>

    <section id="tab-historico" class="tab">
      <h2>Hist√≥rico de domingos</h2>
      <p class="small">Os programas guardados ficam apenas neste dispositivo (localStorage).</p>
      <div id="historyContainer" class="small muted">Ainda n√£o h√° domingos guardados.</div>
      

      <div style="margin-top: 1rem;">
        <button type="button" class="btn btn-delete small" id="clearAllHistoryBtn">üóëÔ∏è Limpar TODO o Hist√≥rico de Domingos</button>
      </div>

    </section>

    <section id="tab-ensaios" class="tab">
      <h2>Ensaios</h2>
      <form id="rehearsalForm">
        <p class="small">Gera uma mensagem para enviar por WhatsApp ou Email com o programa do domingo.</p>
        <div class="row">
          <div class="col">
            <label for="rehearsalDate">Data do ensaio</label>
            <input type="date" id="rehearsalDate">
          </div>
          <div class="col">
            <label for="rehearsalTime">Hora</label>
            <input type="time" id="rehearsalTime">
          </div>
        </div>
        <div class="row">
          <div class="col">
            <label for="rehearsalPlace">Local</label>
            <input type="text" id="rehearsalPlace" placeholder="ex.: Igreja Paroquial">
          </div>
          <div class="col">
            <label for="rehearsalProgram">Programa (domingo)</label>
            <select id="rehearsalProgram">
              <option value="">‚Äî escolher domingo ‚Äî</option>
            </select>
          </div>
        </div>
        <label for="rehearsalNotes">Notas para o ensaio</label>
        <textarea id="rehearsalNotes" placeholder="ex.: Tragam a partitura nova do ofert√≥rio."></textarea>

        <div class="row" style="margin-top: 1rem; gap: 0.5rem;">
          <button type="button" class="btn" id="rehearsalWhatsAppBtn">üì± Enviar WhatsApp</button>
          <button type="button" class="btn secondary" id="rehearsalEmailBtn">üìß Enviar Email (com partituras)</button>
        </div>
      </form>
    </section>

    <section id="tab-partituras" class="tab">
      <h2>üìÅ Partituras</h2>
      <p class="small">Acesso direto √†s partituras do coro no Google Drive.</p>
      
      <!-- Campo de pesquisa -->
      <div style="margin-bottom: 1rem;">
        <label for="partituraSearch">üîç Pesquisar partitura</label>
        <input type="text" id="partituraSearch" placeholder="Escreve o nome do c√¢ntico ou partitura...">
        <p class="small muted" style="margin-top: 0.5rem;">A pesquisa funciona dentro de cada pasta do Google Drive abaixo.</p>
      </div>

      <!-- Pasta 1: Original -->
      <div style="margin-bottom: 2rem;">
        <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem;">üìÇ Partituras - Pasta Principal</h3>
        
        <div style="margin-bottom: 1rem;">
          <a href="https://drive.google.com/drive/folders/10VhjmmmvGcUzg8gdIT3Rlu5iDTFqlJy8?usp=drive_link" 
             target="_blank" 
             class="btn secondary small"
             style="display: inline-flex; align-items: center; gap: 0.5rem;">
            üîó Abrir no Google Drive
          </a>
        </div>

        <!-- Google Drive Embed 1 -->
        <div style="border: 1px solid var(--border-subtle); border-radius: 0.5rem; overflow: hidden; background: white;">
          <iframe 
            id="driveFrame1"
            src="https://drive.google.com/embeddedfolderview?id=10VhjmmmvGcUzg8gdIT3Rlu5iDTFqlJy8#grid" 
            style="width: 100%; height: 500px; border: none;">
          </iframe>
        </div>
      </div>

      <!-- Pasta 2: Nova -->
      <div style="margin-bottom: 2rem;">
        <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem;">üìÇ Partituras - Pasta Adicional</h3>
        
        <div style="margin-bottom: 1rem;">
          <a href="https://drive.google.com/drive/folders/10YDH1vUq67KE1Qd3trMukyacLTjwpVis?usp=drive_link" 
             target="_blank" 
             class="btn secondary small"
             style="display: inline-flex; align-items: center; gap: 0.5rem;">
            üîó Abrir no Google Drive
          </a>
        </div>

        <!-- Google Drive Embed 2 -->
        <div style="border: 1px solid var(--border-subtle); border-radius: 0.5rem; overflow: hidden; background: white;">
          <iframe 
            id="driveFrame2"
            src="https://drive.google.com/embeddedfolderview?id=10YDH1vUq67KE1Qd3trMukyacLTjwpVis#grid" 
            style="width: 100%; height: 500px; border: none;">
          </iframe>
        </div>
      </div>

      <div style="margin-top: 1rem;">
        <details>
          <summary class="small" style="cursor: pointer; padding: 0.5rem; background: var(--bg-soft); border-radius: 0.5rem;">
            üí° Como usar as partituras
          </summary>
          <div style="padding: 1rem; font-size: 0.9rem;">
            <ul>
              <li><strong>Pesquisar:</strong> Usa o campo acima para procurar em ambas as pastas</li>
              <li><strong>Visualizar:</strong> Clica numa partitura para abrir</li>
              <li><strong>Download:</strong> Bot√£o de download no topo direito</li>
              <li><strong>Imprimir:</strong> Menu "Ficheiro" ‚Üí "Imprimir"</li>
              <li><strong>Organiza√ß√£o:</strong> Partituras organizadas por tempo lit√∫rgico e alfabeticamente</li>
              <li><strong>Duas pastas:</strong> Temos 2 pastas diferentes com partituras - podes procurar em ambas</li>
            </ul>
          </div>
        </details>
      </div>
    </section>

    <section id="tab-videos" class="tab">
      <h2>üé• V√≠deos dos C√¢nticos</h2>
      <p class="small">V√™ e ouve os c√¢nticos do repert√≥rio para ensaiar.</p>

      <!-- Filtros -->
      <div class="row" style="margin-bottom: 1rem;">
        <div class="col">
          <label for="videoSearch">Pesquisar c√¢ntico</label>
          <input type="text" id="videoSearch" placeholder="Nome do c√¢ntico...">
        </div>
        <div class="col">
          <label for="videoSection">Sec√ß√£o</label>
          <select id="videoSection">
            <option value="">Todas</option>
            <option value="Entrada">Entrada</option>
            <option value="Gl√≥ria">Gl√≥ria</option>
            <option value="Salmo">Salmo</option>
            <option value="Aclama√ß√£o">Aclama√ß√£o</option>
            <option value="Ofert√≥rio">Ofert√≥rio</option>
            <option value="Santo">Santo</option>
            <option value="Cordeiro">Cordeiro</option>
            <option value="Comunh√£o">Comunh√£o</option>
            <option value="Final">Final</option>
          </select>
        </div>
      </div>

      <!-- Container de v√≠deos -->
      <div id="videosContainer" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1rem;">
        <p class="small muted">Seleciona um c√¢ntico do cat√°logo para ver o v√≠deo...</p>
      </div>

      <div style="margin-top: 1.5rem; padding: 1rem; background: var(--bg-soft); border-radius: 0.5rem; border-left: 4px solid var(--primary);">
        <p class="small" style="margin: 0;"><strong>üí° Dica:</strong> Podes adicionar links de v√≠deo do YouTube no cat√°logo de c√¢nticos (coluna "Video" do Google Sheets).</p>
      </div>
    </section>
  </div>

<div id="lyricsModal" class="modal" style="display:none;">
  <div class="modal-backdrop" style="position:fixed;inset:0;background:rgba(0,0,0,0.35);"></div>
  <div class="modal-dialog" style="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#ffffff;padding:1rem 1.25rem;border-radius:12px;max-width:600px;width:90%;box-shadow:0 18px 45px rgba(15,23,42,0.25);">
    <h3 style="margin-top:0;">Letra do c√¢ntico</h3>
    <p id="lyricsModalTitle" class="small muted" style="margin-bottom:0.5rem;"></p>
    
<div id="lyricsEditorToolbar">
  <span class="ql-formats">
    <button class="ql-bold"></button>
    <button class="ql-italic"></button>
    <button class="ql-underline"></button>
  </span>
  <span class="ql-formats">
    <button class="ql-list" value="ordered"></button>
    <button class="ql-list" value="bullet"></button>
  </span>
  <span class="ql-formats">
    <button class="ql-link"></button>
    <button class="ql-clean"></button>
    <button class="ql-header" value="3"></button>
    <button class="ql-chord">Acorde</button>
  </span>
</div>
<div id="lyricsEditor" style="height:250px;"></div>

    <div style="margin-top:0.75rem; text-align:right; display:flex; gap:0.5rem; justify-content:flex-end;">
      <button type="button" class="btn secondary" id="lyricsModalCancel">Cancelar</button>
      <button type="button" class="btn" id="lyricsModalSave">Guardar letra</button>
    </div>
  </div>
</div>
</main>

<div id="toastContainer" class="toast-container"></div>


<!-- Modais do programa: sele√ß√£o de c√¢ntico e edi√ß√£o de letra -->
<div class="modal-backdrop" id="songSelectModal" hidden>
  <div class="modal">
    <h3>Selecionar c√¢ntico</h3>
    <p class="small" id="songSelectPartLabel"></p>
    <div class="song-select-filters">
      <div class="col">
        <label for="songSelectSearch">Pesquisar</label>
        <input type="text" id="songSelectSearch" placeholder="T√≠tulo, tema, autor‚Ä¶">
      </div>
      <div class="col">
        <label for="songSelectTheme">Tema</label>
        <select id="songSelectTheme">
          <option value="">Todos</option>
        </select>
      </div>
    </div>

    <div id="songSelectSuggestions" class="small" style="margin-bottom:0.75rem; display:none;">
      <p class="small" style="margin-bottom:0.25rem;"><strong>‚ú® Sugest√µes para esta parte</strong></p>
      <div id="songSelectSuggestionsList"></div>
    </div>

    <div id="songSelectList" class="song-select-list">
      <p class="small muted">Cat√°logo a carregar‚Ä¶</p>
    </div>
    <div class="modal-actions">
      <button type="button" class="btn secondary" id="songSelectCloseBtn">Fechar</button>
    </div>
  </div>
</div>

<div class="modal-backdrop" id="programLyricsModal" hidden>
  <div class="modal">
    <h3 id="programLyricsModalTitle">Editar letra</h3>
    <p class="small" id="programLyricsModalSong"></p>
    <textarea id="programLyricsTextarea" placeholder="Letra a usar neste programa."></textarea>
    <div class="modal-actions">
      <button type="button" class="btn secondary" id="programLyricsCancelBtn">Cancelar</button>
      <button type="button" class="btn" id="programLyricsSaveBtn">Guardar</button>
    </div>
  </div>
</div>








  
  
  
  


<div class="modal-backdrop" id="songEditModal" hidden>
  <div class="modal">
    <h3>‚úèÔ∏è Editar c√¢ntico antes de inserir</h3>
    <div class="row">
      <div class="col">
        <label for="songEditTitle">T√≠tulo</label>
        <input type="text" id="songEditTitle" placeholder="T√≠tulo do c√¢ntico">
      </div>
      <div class="col">
        <label for="songEditKey">Tom</label>
        <input type="text" id="songEditKey" placeholder="Ex.: R√©, Mi‚ô≠, etc.">
      </div>
    </div>
    <div class="row">
      <div class="col">
        <label for="songEditLyrics">Letra</label>
        <textarea id="songEditLyrics" placeholder="Letra a usar neste programa. Pode incluir acordes entre [] se quiser."></textarea>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <label for="songEditChords">Acordes (opcional)</label>
        <textarea id="songEditChords" placeholder="Sequ√™ncia de acordes, notas para m√∫sicos‚Ä¶"></textarea>
      </div>
      <div class="col">
        <label for="songEditNotes">Notas internas (opcional)</label>
        <textarea id="songEditNotes" placeholder="Notas internas para o coro ou organista."></textarea>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <label for="songEditPartSelect">Sec√ß√£o do programa</label>
        <select id="songEditPartSelect"></select>
      </div>
    </div>
    <div class="modal-actions">
      <button type="button" class="btn secondary" id="songEditCancelBtn">Cancelar</button>
      <button type="button" class="btn" id="songEditSaveInsertBtn">Guardar e inserir</button>
    </div>
  </div>
</div>

<!-- Modal de Hist√≥rico de Uso do C√¢ntico -->
<div id="songUsageModal" class="modal-backdrop" style="display: none;">
  <div class="modal" style="max-width: 600px;">
    <h3 id="songUsageModalTitle">Hist√≥rico de Utiliza√ß√£o</h3>
    <div id="songUsageModalContent" style="max-height: 400px; overflow-y: auto;">
    </div>
    <div class="modal-actions">
      <button type="button" class="btn secondary" id="songUsageModalClose">Fechar</button>
    </div>
  </div>
</div>

<!-- Modal de Adicionar C√¢ntico Personalizado -->
<div id="customSongModal" class="modal-backdrop" style="display: none;">
  <div class="modal" style="max-width: 650px;">
    <h3>‚ûï Adicionar C√¢ntico Personalizado</h3>
    <p class="small muted">Cria um c√¢ntico com partitura em PDF ou imagem (foto/scan)</p>
    
    <form id="customSongForm">
      <div style="margin-bottom: 1rem;">
        <label><strong>T√≠tulo do C√¢ntico *</strong></label>
        <input type="text" id="customSongTitle" required placeholder="Ex: Ave Maria de F√°tima">
      </div>

      <div style="margin-bottom: 1rem;">
        <label><strong>Sec√ß√£o Lit√∫rgica</strong></label>
        <select id="customSongSection">
          <option value="">Nenhuma</option>
          <option value="Entrada">Entrada</option>
          <option value="Gl√≥ria">Gl√≥ria</option>
          <option value="Salmo">Salmo</option>
          <option value="Aleluia">Aleluia</option>
          <option value="Ofert√≥rio">Ofert√≥rio</option>
          <option value="Santo">Santo</option>
          <option value="Comunh√£o">Comunh√£o</option>
          <option value="Final">Final</option>
          <option value="Outro">Outro</option>
        </select>
      </div>

      <div style="margin-bottom: 1rem;">
        <label><strong>Autor</strong></label>
        <input type="text" id="customSongAuthor" placeholder="Ex: Marco Frisina">
      </div>

      <div style="margin-bottom: 1rem;">
        <label><strong>Observa√ß√µes</strong></label>
        <textarea id="customSongNotes" rows="2" placeholder="Notas sobre o c√¢ntico..."></textarea>
      </div>

      <div style="margin-bottom: 1rem; padding: 1rem; background: #f0f9ff; border-radius: 0.5rem; border-left: 4px solid #0284c7;">
        <label style="display: block; margin-bottom: 0.5rem;"><strong>üìÑ Partitura (PDF ou Imagem)</strong></label>
        
        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 0.75rem;">
          <button type="button" class="btn secondary small" id="uploadFileBtn">
            üìÅ Escolher Ficheiro
          </button>
          <button type="button" class="btn secondary small" id="takePictureBtn">
            üì∑ Tirar Foto
          </button>
        </div>

        <input type="file" id="customSongFile" accept="application/pdf,image/*" style="display: none;">
        <input type="file" id="customSongCamera" accept="image/*" capture="environment" style="display: none;">
        
        <div id="filePreview" style="display: none; margin-top: 0.75rem; padding: 0.75rem; background: white; border-radius: 0.5rem;">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
              <strong id="fileName"></strong>
              <br>
              <small class="muted" id="fileSize"></small>
            </div>
            <button type="button" class="btn secondary small" id="removeFileBtn">üóëÔ∏è Remover</button>
          </div>
          <img id="imagePreview" style="max-width: 100%; margin-top: 0.5rem; display: none; border-radius: 0.25rem;">
        </div>

        <p class="small muted" style="margin-top: 0.5rem; margin-bottom: 0;">
          üí° Formatos aceites: PDF, JPG, PNG. M√°ximo 5MB.
        </p>
      </div>

      <div class="modal-actions">
        <button type="button" class="btn secondary" id="customSongModalClose">Cancelar</button>
        <button type="submit" class="btn">üíæ Guardar C√¢ntico</button>
      </div>
    </form>
  </div>
</div>

<!-- Modal de Visualizar C√¢ntico Personalizado -->
<div id="viewCustomSongModal" class="modal-backdrop" style="display: none;">
  <div class="modal" style="max-width: 800px;">
    <h3 id="viewCustomSongTitle">C√¢ntico Personalizado</h3>
    
    <div id="viewCustomSongContent">
      <div style="margin-bottom: 1rem;">
        <strong>Sec√ß√£o:</strong> <span id="viewSongSection"></span>
      </div>
      <div style="margin-bottom: 1rem;">
        <strong>Autor:</strong> <span id="viewSongAuthor"></span>
      </div>
      <div style="margin-bottom: 1rem;" id="viewSongNotesContainer">
        <strong>Observa√ß√µes:</strong>
        <p id="viewSongNotes" style="margin-top: 0.25rem;"></p>
      </div>
      
      <div id="viewSongFileContainer" style="margin-top: 1.5rem;">
        <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
          <button type="button" class="btn secondary" id="downloadSongFileBtn">
            ‚¨áÔ∏è Download Partitura
          </button>
          <button type="button" class="btn secondary" id="openSongFileBtn">
            üîç Abrir em Nova Aba
          </button>
        </div>
        <div id="pdfViewer" style="display: none;">
          <embed id="pdfEmbed" type="application/pdf" style="width: 100%; height: 500px; border-radius: 0.5rem;">
        </div>
        <div id="imageViewer" style="display: none;">
          <img id="imageView" style="max-width: 100%; border-radius: 0.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        </div>
      </div>
    </div>

    <div class="modal-actions">
      <button type="button" class="btn secondary" id="viewCustomSongClose">Fechar</button>
    </div>
  </div>
</div>

<script src="scripts/scripts.js"></script>
</body>
</html>
